---
import { getLocaleFromUrl, getLocalizedPath, t } from '../i18n/utils';

const locale = getLocaleFromUrl(Astro.url);
const year = new Date().getFullYear();

const toolLinks = [
  { label: t(locale, 'tools.webp.title'), href: getLocalizedPath('/tools/webp', locale) },
  { label: t(locale, 'tools.heic.title'), href: getLocalizedPath('/tools/heic', locale) },
  { label: t(locale, 'tools.winmail.title'), href: getLocalizedPath('/tools/winmail', locale) },
];

const blogLinks = [
  { label: locale === 'ja' ? 'Winmail.datとは？' : 'What Is Winmail.dat?', href: getLocalizedPath('/blog/what-is-winmail-dat', locale) },
  { label: locale === 'ja' ? 'HEIC vs JPG比較' : 'HEIC vs JPG', href: getLocalizedPath('/blog/heic-vs-jpg', locale) },
  { label: locale === 'ja' ? 'WebP完全解説' : 'WebP Explained', href: getLocalizedPath('/blog/webp-explained', locale) },
  { label: locale === 'ja' ? 'すべての記事' : 'All posts', href: getLocalizedPath('/blog', locale) },
];

const legalLinks = [
  { label: t(locale, 'footer.privacy'), href: getLocalizedPath('/privacy', locale) },
  { label: t(locale, 'footer.terms'), href: getLocalizedPath('/terms', locale) },
  { label: t(locale, 'footer.about'), href: getLocalizedPath('/about', locale) },
  { label: t(locale, 'footer.contact'), href: getLocalizedPath('/contact', locale) },
];
---

<footer class="border-t border-gray-200 bg-gray-50 dark:border-gray-800 dark:bg-gray-900">
  <div class="mx-auto max-w-6xl px-4 py-12 sm:px-6 lg:px-8">
    <div class="grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-5">
      <!-- Brand -->
      <div class="sm:col-span-2">
        <a href={getLocalizedPath('/', locale)} class="flex items-center gap-2 text-lg font-bold text-gray-900 dark:text-white">
          <svg class="w-6 h-6 text-primary-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"></path>
            <path d="M14 2v4a2 2 0 0 0 2 2h4"></path>
            <path d="m9 15 2 2 4-4"></path>
          </svg>
          OpenedFile
        </a>
        <p class="mt-3 text-sm text-gray-500 dark:text-gray-400 max-w-sm">
          {t(locale, 'footer.tagline')}
        </p>
        <!-- Privacy badge in footer -->
        <div class="mt-4 inline-flex items-center gap-1.5 text-xs text-green-600 dark:text-green-400">
          <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path>
            <path d="m9 12 2 2 4-4"></path>
          </svg>
          <span>{t(locale, 'privacy_badge.short')}</span>
        </div>
      </div>

      <!-- Tool links -->
      <div>
        <h3 class="text-sm font-semibold text-gray-900 dark:text-white">{t(locale, 'footer.tools_title')}</h3>
        <ul class="mt-3 space-y-2">
          {toolLinks.map((link) => (
            <li>
              <a
                href={link.href}
                class="text-sm text-gray-500 hover:text-primary-600 dark:text-gray-400 dark:hover:text-primary-400 transition-colors"
              >
                {link.label}
              </a>
            </li>
          ))}
        </ul>
      </div>

      <!-- Blog links -->
      <div>
        <h3 class="text-sm font-semibold text-gray-900 dark:text-white">{t(locale, 'footer.blog_title')}</h3>
        <ul class="mt-3 space-y-2">
          {blogLinks.map((link) => (
            <li>
              <a
                href={link.href}
                class="text-sm text-gray-500 hover:text-primary-600 dark:text-gray-400 dark:hover:text-primary-400 transition-colors"
              >
                {link.label}
              </a>
            </li>
          ))}
        </ul>
      </div>

      <!-- Legal links -->
      <div>
        <h3 class="text-sm font-semibold text-gray-900 dark:text-white">{t(locale, 'footer.legal_title')}</h3>
        <ul class="mt-3 space-y-2">
          {legalLinks.map((link) => (
            <li>
              <a
                href={link.href}
                class="text-sm text-gray-500 hover:text-primary-600 dark:text-gray-400 dark:hover:text-primary-400 transition-colors"
              >
                {link.label}
              </a>
            </li>
          ))}
        </ul>
      </div>
    </div>

    <!-- Copyright -->
    <div class="mt-10 border-t border-gray-200 pt-6 dark:border-gray-800">
      <p class="text-center text-xs text-gray-400 dark:text-gray-500">
        &copy; {year} {t(locale, 'footer.copyright')}
      </p>
    </div>
  </div>
</footer>
