---
import BlogLayout from '../../../layouts/BlogLayout.astro';
---

<BlogLayout
  title="Winmail.datの問題を防ぐ：Outlook設定ガイド"
  description="Microsoft Outlookの設定を変更して、受信者にwinmail.datファイルが送られないようにする方法。"
  date="2026-02-21"
  category="Winmail.dat"
  readingTime="5分で読めます"
  relatedTools={[{ name: "Winmail.dat ビューア", href: "/ja/tools/winmail" }]}
>
  <h2>OutlookがWinmail.datを送信する理由</h2>
  <p>
    あなたが送ったメールに「winmail.dat」というファイルが添付されていると指摘されたことはありませんか？これはMicrosoft Outlookのメール送信形式がリッチテキスト形式（RTF）に設定されている場合に発生します。
  </p>
  <p>
    Outlookがリッチテキスト形式でメールを送信すると、メッセージの書式情報や添付ファイルがTNEF（Transport Neutral Encapsulation Format）という独自の形式でエンコードされます。このエンコードされたデータがwinmail.datファイルとしてメールに添付され、Outlook以外のメールクライアントを使用している受信者には、意味不明な添付ファイルとして表示されてしまいます。
  </p>
  <p>
    特に問題なのは、送信者自身はwinmail.datの存在に気づかないことが多い点です。Outlookの送信済みフォルダを確認しても、自分の環境ではリッチテキストが正常に表示されるため、受信者が困っていることに気づきにくいのです。
  </p>

  <h2>メール送信形式の確認方法</h2>
  <p>
    まず、現在のOutlookのメール送信形式を確認しましょう。以下の手順で確認できます：
  </p>
  <ul>
    <li>Outlookを開きます</li>
    <li>「ファイル」メニューをクリックします</li>
    <li>「オプション」を選択します</li>
    <li>左側のメニューから「メール」をクリックします</li>
    <li>「メッセージの作成」セクションの「次の形式でメッセージを作成する」を確認します</li>
  </ul>
  <p>
    ここが「リッチテキスト形式」になっている場合、送信するすべてのメールでwinmail.datが生成される可能性があります。「HTML」または「テキスト形式」に変更することで、問題を解決できます。
  </p>

  <h2>Outlook 365（Microsoft 365）での設定変更</h2>
  <p>
    最新のOutlook 365（Microsoft 365に含まれるOutlook）での設定変更手順を解説します。
  </p>

  <h3>デフォルトのメール形式を変更する</h3>
  <ul>
    <li>Outlookを開き、「ファイル」タブをクリックします</li>
    <li>「オプション」をクリックします</li>
    <li>左側のパネルで「メール」を選択します</li>
    <li>「メッセージの作成」セクションを見つけます</li>
    <li>「次の形式でメッセージを作成する」のドロップダウンから「HTML」を選択します</li>
    <li>「OK」ボタンをクリックして設定を保存します</li>
  </ul>

  <h3>インターネットメールのTNEF設定を無効化する</h3>
  <p>
    デフォルト形式をHTMLに変更しても、特定の条件下でTNEFが使用される場合があります。以下の追加設定も確認してください：
  </p>
  <ul>
    <li>「ファイル」→「オプション」→「メール」を開きます</li>
    <li>「メッセージ形式」セクションまでスクロールします</li>
    <li>「インターネットの受信者にリッチテキスト形式のメッセージを送信する場合」の設定を「HTML形式に変換」に変更します</li>
    <li>「OK」をクリックして保存します</li>
  </ul>

  <h2>Outlook 2019での設定変更</h2>
  <p>
    Outlook 2019での手順はOutlook 365とほぼ同様です：
  </p>
  <ul>
    <li>「ファイル」→「オプション」→「メール」を開きます</li>
    <li>「次の形式でメッセージを作成する」を「HTML」に変更します</li>
    <li>「メッセージ形式」セクションで、インターネット受信者向けの設定も「HTML形式に変換」に変更します</li>
    <li>「OK」で保存します</li>
  </ul>

  <h2>Outlook 2016での設定変更</h2>
  <p>
    Outlook 2016でも同じ設定画面から変更が可能です：
  </p>
  <ul>
    <li>「ファイル」→「オプション」→「メール」を開きます</li>
    <li>「次の形式でメッセージを作成する」のドロップダウンを「HTML」に変更します</li>
    <li>下にスクロールし、リッチテキストのインターネット送信設定も確認します</li>
    <li>「OK」で保存します</li>
  </ul>
  <p>
    なお、Outlook 2016ではデフォルトの送信形式がHTMLに設定されていることが多いですが、組織のグループポリシーやExchangeの設定によって変更されている場合があります。
  </p>

  <h2>連絡先ごとの設定を確認・変更する</h2>
  <p>
    Outlookでは、特定の連絡先に対してメール形式を個別に設定することができます。デフォルトの送信形式をHTMLに変更しても、特定の連絡先にはリッチテキスト形式で送信される設定になっている場合があります。
  </p>

  <h3>連絡先の設定確認手順</h3>
  <ul>
    <li>Outlookの「連絡先」（People）を開きます</li>
    <li>該当する連絡先をダブルクリックして編集画面を開きます</li>
    <li>連絡先のメールアドレスをダブルクリックします</li>
    <li>「インターネットメールの形式」の設定を確認します</li>
    <li>「Outlookのデフォルト形式で送信」または「テキスト形式で送信」「HTML形式で送信」から選択します</li>
    <li>「リッチテキスト形式で送信」が選択されている場合は、別のオプションに変更してください</li>
    <li>「OK」で保存します</li>
  </ul>
  <p>
    この個別設定は、デフォルトのメール形式設定よりも優先されます。つまり、デフォルトをHTMLに設定していても、連絡先レベルでリッチテキストが指定されていると、その連絡先に対してはwinmail.datが生成されてしまいます。
  </p>

  <h2>Exchange管理者による組織レベルの設定</h2>
  <p>
    組織のIT管理者は、Exchange Serverの設定でTNEFの使用を組織全体で制御することができます。これにより、個々のユーザーの設定に関わらず、外部宛のメールでwinmail.datが生成されないようにすることが可能です。
  </p>

  <h3>Exchange Online（Microsoft 365）の場合</h3>
  <p>
    Exchange Onlineの管理者は、Exchange管理センターまたはPowerShellを使用してTNEFを無効化できます。
  </p>
  <ul>
    <li><strong>リモートドメイン設定</strong> - Exchange管理センターの「メールフロー」→「リモートドメイン」で、TNEFの使用を「なし」に設定できます</li>
    <li><strong>PowerShellコマンド</strong> - <code>Set-RemoteDomain -Identity Default -TNEFEnabled $false</code> で、デフォルトのリモートドメインポリシーでTNEFを無効化できます</li>
    <li><strong>トランスポートルール</strong> - メールフロールールを作成して、外部送信時にTNEFを自動的にHTML形式に変換することもできます</li>
  </ul>

  <h3>Exchange Server（オンプレミス）の場合</h3>
  <p>
    オンプレミスのExchange Serverでも、同様の設定が可能です：
  </p>
  <ul>
    <li>Exchange管理コンソール（EMC）から設定する方法</li>
    <li>Exchange Management Shellを使用してPowerShellコマンドで設定する方法</li>
    <li>グループポリシーを使用してOutlookクライアントの設定を一括管理する方法</li>
  </ul>
  <p>
    組織レベルでTNEFを無効化することは、外部パートナーや顧客とのコミュニケーションにおける問題を根本的に解決する最も効果的な方法です。
  </p>

  <h2>Mac版Outlookでの設定</h2>
  <p>
    Mac版のMicrosoft Outlookでも、メール送信形式の設定を変更することができます。
  </p>
  <ul>
    <li>Outlookメニューから「環境設定」を開きます</li>
    <li>「メール作成」をクリックします</li>
    <li>「メッセージ形式」セクションで、HTML形式を選択します</li>
    <li>「新しいメールの作成形式」がHTML形式になっていることを確認します</li>
  </ul>
  <p>
    Mac版OutlookはWindows版と比較して、デフォルトでHTML形式が使用されることが多いため、winmail.datの問題は比較的少ないですが、確認しておくことをおすすめします。
  </p>

  <h2>設定変更後のテスト方法</h2>
  <p>
    Outlookの設定を変更した後は、実際にwinmail.datが生成されなくなったことをテストすることが重要です。以下の手順でテストしてください：
  </p>

  <h3>テスト手順</h3>
  <ul>
    <li><strong>テストメールの送信</strong> - Gmailなど、Outlook以外のメールアドレスを持っている場合は、そのアドレスにテストメールを送信します。添付ファイルも一つ添えてください</li>
    <li><strong>受信確認</strong> - Outlook以外のメールクライアントでテストメールを開き、winmail.datが添付されていないことを確認します</li>
    <li><strong>添付ファイルの確認</strong> - 添付したファイルが正しいファイル名で受信されていることを確認します</li>
    <li><strong>書式の確認</strong> - メール本文の書式（太字、色、リンクなど）が正しく表示されていることを確認します</li>
  </ul>

  <h3>テスト時の注意点</h3>
  <p>
    設定変更後、すでに作成済みのメールや下書きには古い設定が適用される場合があります。テストは必ず新規メールで行ってください。また、返信や転送の場合も、元のメールの形式が引き継がれることがあるため、新規作成メールでテストすることが重要です。
  </p>

  <h2>TNEFが必要な場合</h2>
  <p>
    すべてのケースでTNEFを無効化すべきというわけではありません。以下のようなOutlook固有の機能を使用する場合は、TNEFが必要になることがあります：
  </p>
  <ul>
    <li><strong>投票ボタン</strong> - Outlookのメールに投票ボタンを追加する機能はTNEFに依存しています</li>
    <li><strong>カスタムOutlookフォーム</strong> - 組織内で使用されるカスタムフォームはTNEFで転送されます</li>
    <li><strong>特殊なリッチテキスト書式</strong> - 一部の複雑な書式はHTMLでは完全に再現できない場合があります</li>
  </ul>
  <p>
    これらの機能を使用する必要がある場合は、組織内部（同じExchange環境内）の通信ではTNEFを有効にしたまま、外部への通信のみTNEFを無効化するという方法が推奨されます。Exchange管理者がリモートドメインの設定で、この使い分けを実現できます。
  </p>

  <h2>まとめ</h2>
  <p>
    winmail.datの問題は、Outlookのメール送信形式を変更することで簡単に防ぐことができます。最も重要な設定変更は以下の2点です：
  </p>
  <ul>
    <li><strong>デフォルトのメール形式をHTMLに変更する</strong> - 「ファイル」→「オプション」→「メール」から設定</li>
    <li><strong>インターネット受信者向けのリッチテキスト送信を無効化する</strong> - 同じ設定画面の「メッセージ形式」セクションで設定</li>
  </ul>
  <p>
    また、特定の連絡先に個別設定が残っていないかも確認してください。組織全体で問題を解決するには、Exchange管理者によるリモートドメインの設定変更が最も効果的です。
  </p>
  <p>
    もしwinmail.datファイルを受信してしまった場合は、<a href="/ja/tools/winmail">OpenedFileのWinmail.datビューア</a>を使えば、ブラウザ上で簡単に内容を確認できます。技術的な背景を詳しく知りたい方は、<a href="/ja/blog/tnef-explained">OutlookのTNEFエンコーディングを理解する</a>の記事もご参照ください。
  </p>
</BlogLayout>
