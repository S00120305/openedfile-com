---
import ToolLayout from '../../layouts/ToolLayout.astro';
import WebPConverter from '../../components/react/WebPConverter';
import { t } from '../../i18n/utils';

const locale = 'en';

const labels = {
  outputFormat: t(locale, 'webp_converter.output_format'),
  quality: t(locale, 'webp_converter.quality'),
  dropTitle: t(locale, 'webp_converter.drop_title'),
  dropDescription: t(locale, 'webp_converter.drop_description'),
  dropHint: t(locale, 'webp_converter.drop_hint'),
  convertAll: t(locale, 'webp_converter.convert_all'),
  converting: t(locale, 'webp_converter.converting'),
  download: t(locale, 'webp_converter.download'),
  downloadAllZip: t(locale, 'webp_converter.download_all_zip'),
  clearAll: t(locale, 'webp_converter.clear_all'),
  originalSize: t(locale, 'webp_converter.original_size'),
  convertedSize: t(locale, 'webp_converter.converted_size'),
  reduction: t(locale, 'webp_converter.reduction'),
  increase: t(locale, 'webp_converter.increase'),
  errorNotWebp: t(locale, 'webp_converter.error_not_webp'),
  errorConversionFailed: t(locale, 'webp_converter.error_conversion_failed'),
  errorFileTooLarge: t(locale, 'webp_converter.error_file_too_large'),
  filesSelected: t(locale, 'webp_converter.files_selected'),
  converted: t(locale, 'webp_converter.converted'),
  pending: t(locale, 'webp_converter.pending'),
  statusConverting: t(locale, 'webp_converter.status_converting'),
  statusDone: t(locale, 'webp_converter.status_done'),
  statusError: t(locale, 'webp_converter.status_error'),
};

import en from '../../i18n/en.json';
const steps = en.webp_page.how_to_steps;
const faqItems = en.webp_page.faq;

const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": faqItems.map((item) => ({
    "@type": "Question",
    "name": item.question,
    "acceptedAnswer": {
      "@type": "Answer",
      "text": item.answer,
    },
  })),
};

const stepIcons = [
  // Upload icon
  '<svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>',
  // Settings icon
  '<svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>',
  // Slider icon
  '<svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><line x1="4" x2="4" y1="21" y2="14"/><line x1="4" x2="4" y1="10" y2="3"/><line x1="12" x2="12" y1="21" y2="12"/><line x1="12" x2="12" y1="8" y2="3"/><line x1="20" x2="20" y1="21" y2="16"/><line x1="20" x2="20" y1="12" y2="3"/><line x1="2" x2="6" y1="14" y2="14"/><line x1="10" x2="14" y1="8" y2="8"/><line x1="18" x2="22" y1="16" y2="16"/></svg>',
  // Download icon
  '<svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>',
];
---

<ToolLayout
  title={t(locale, 'tools.webp.page_title')}
  description={t(locale, 'tools.webp.page_description')}
  heading={t(locale, 'tools.webp.heading')}
  subheading={t(locale, 'tools.webp.subheading')}
>
  <WebPConverter client:load labels={labels} />

  <Fragment slot="seo-content">
    <!-- How to use section -->
    <section class="mx-auto max-w-6xl px-4 py-16 sm:px-6 lg:px-8">
      <div class="max-w-3xl">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white sm:text-3xl">
          {t(locale, 'webp_page.how_to_title')}
        </h2>

        <!-- Intro paragraphs -->
        <div class="mt-6 space-y-4 text-base leading-relaxed text-gray-600 dark:text-gray-300">
          {t(locale, 'webp_page.how_to_intro').split('\n\n').map((p: string) => (
            <p>{p}</p>
          ))}
        </div>

        <!-- Step cards -->
        <div class="mt-10 space-y-4">
          {steps.map((step, i) => (
            <div class="flex gap-4 rounded-xl border border-gray-200 bg-white p-5 dark:border-gray-700 dark:bg-gray-800/60">
              <div class="flex shrink-0 items-center justify-center w-10 h-10 rounded-lg bg-primary-50 text-primary-600 dark:bg-primary-950 dark:text-primary-400">
                <span class="text-sm font-bold">{i + 1}</span>
              </div>
              <div class="min-w-0">
                <h3 class="font-semibold text-gray-900 dark:text-white">{step.title}</h3>
                <p class="mt-1.5 text-sm leading-relaxed text-gray-500 dark:text-gray-400">
                  {step.description}
                </p>
              </div>
            </div>
          ))}
        </div>

        <!-- Outro -->
        <div class="mt-8 text-base leading-relaxed text-gray-600 dark:text-gray-300">
          <p>{t(locale, 'webp_page.how_to_outro')}</p>
        </div>
      </div>
    </section>

    <!-- Divider -->
    <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">
      <hr class="border-gray-200 dark:border-gray-800" />
    </div>

    <!-- FAQ section -->
    <section class="mx-auto max-w-6xl px-4 py-16 sm:px-6 lg:px-8">
      <div class="max-w-3xl">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white sm:text-3xl mb-8">
          {t(locale, 'webp_page.faq_title')}
        </h2>
        <div class="space-y-3">
          {faqItems.map((item) => (
            <details class="group rounded-xl border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800/60 overflow-hidden">
              <summary class="flex cursor-pointer items-center justify-between gap-4 p-5 text-left font-medium text-gray-900 dark:text-white select-none hover:bg-gray-50 dark:hover:bg-gray-800">
                <span class="leading-snug">{item.question}</span>
                <svg class="h-5 w-5 shrink-0 text-gray-400 transition-transform duration-200 group-open:rotate-180" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                  <polyline points="6 9 12 15 18 9" />
                </svg>
              </summary>
              <div class="px-5 pb-5 -mt-1 text-sm leading-relaxed text-gray-600 dark:text-gray-300">
                {item.answer}
              </div>
            </details>
          ))}
        </div>
      </div>
    </section>

    <!-- FAQ Schema JSON-LD -->
    <script type="application/ld+json" set:html={JSON.stringify(faqSchema)} />
  </Fragment>
</ToolLayout>
